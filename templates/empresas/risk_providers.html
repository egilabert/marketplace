{% extends "app_base.html" %}
{% load static %}
{% load humanize %}
{% load mathfilters %}
{% block page_title %}
{{ company.name }}
{% endblock %}

{% block body_class %}background_grey{% endblock %}
{% block side-nav %}{% include "side-nav.html" %}{% endblock %}
{% block content %}
<div class="parallax-container">
		<h3 class="center-align white-text text-darken-3 light">El riesgo proveedor</h3>
		<div class="row center white_back-text text-darken-3">{{company.name}}</div>
		<div class="row center">

			<div class="col m4 s3">
				<a href="{% url 'empresas:recommendations_financial_risk' %}" id="download-button" class="btn-large waves-effect waves-light transparent pad_top white-text text-darken-3 border-grey">Riesgo financiero </a>
			</div>
			<div class="col m4 s3">
				<a href="{% url 'empresas:recommendations_client_risk' %}" id="download-button" class="btn-large waves-effect waves-light transparent pad_top white-text text-darken-3 border-grey">Riesgo cliente  </a>
			</div>
			<div class="col m4 s3">
				<a href="{% url 'empresas:recommendations_provider_risk' %}" id="download-button" class="btn-large waves-effect waves-light alpha_back pad_top orange-text text-darken-4 border-grey">Riesgo proveedor </a>
			</div>
			
        </div>
	    <div class="parallax"><img src="{% static 'images/lego2.jpg' %}"></div>
	</div>

<div class="mdl-card mdl-shadow--2dp">

      <div class="mdl-card__supporting-text">

        <div class="mdl-stepper-horizontal-alternative">
          
          <div class="mdl-stepper-step active-step step-done">
            <a href="{% url 'empresas:detail' pk=company.pk %}">
              <div class="mdl-stepper-circle"><span>1</span></div>
              <div class="mdl-stepper-title">Revisión cliente</div>
              <div class="mdl-stepper-bar-left"></div>
              <div class="mdl-stepper-bar-right"></div>
            </a>
          </div>
          
          <div class="mdl-stepper-step active-step step-done">
            <a href="{% url 'empresas:recommendations' %}">
              <div class="mdl-stepper-circle"><span>2</span></div>
              <div class="mdl-stepper-title">Clientes/Proveedores</div>
              <div class="mdl-stepper-optional">Comparativa</div>
              <div class="mdl-stepper-bar-left"></div>
              <div class="mdl-stepper-bar-right"></div>
            </a>
          </div>
          <div class="mdl-stepper-step active-step">
            <a href="{% url 'empresas:recommendations_financial_risk' %}">
              <div class="mdl-stepper-circle"><span>3</span></div>
              <div class="mdl-stepper-title">Riesgos</div>
              <div class="mdl-stepper-optional">Comparativa</div>
              <div class="mdl-stepper-optional"></div>
              <div class="mdl-stepper-bar-left"></div>
              <div class="mdl-stepper-bar-right"></div>
            </a>
          </div>
          <div class="mdl-stepper-step">
            <a href="{% url 'empresas:informe' %}">
              <div class="mdl-stepper-circle"><span>4</span></div>
              <div class="mdl-stepper-title">Recomendaciones</div>
              <div class="mdl-stepper-optional">Informe</div>
              <div class="mdl-stepper-bar-left"></div>
              <div class="mdl-stepper-bar-right"></div>
            </a>
          </div>
        </div>

      </div>

  </div>


{% if company.id == 990 %}
  <div class="row">
  <div class="col s12 m1"></div>
  <div class="col s12 m5">
    <p class="flow-text center-align">Puntos fuertes</p>
    <div class="card horizontal green lighten-2 black-text">
      <div class="card-stacked">
        <div class="card-content">
          <p>Alta <strong>diversificación en proveedores</strong> con un índice de concentración del {{company.hhi_providers|floatformat:2}}</p>
        </div>
      </div>
    </div>
  </div>
  
  <div class="col s12 m5">
  <p class="flow-text center-align">Puntos a mejorar</p>
    <div class="card horizontal grey lighten-3 black-text">
      <div class="card-stacked">
        <div class="card-content">
          <p>Tiene una dependencia del {{dependencia|mul:100|floatformat:0}}% en sus clientes, una cifra muy superior a la de su competencia</p>
        </div>
        <div class="divider"></div>
        <div class="card-content">
          <p>Alta <strong>concentración geográfica en proveedores</strong> con un índice de concentración del {{company.hhi_geografical_providers|floatformat:2}}</p>
        </div>
        </div>
      </div>
    </div>
  </div>
  <div class="col s12 m1"></div>
</div>
{% elif company.id == 1610 %}
<div class="row">
  <div class="col s12 m1"></div>
  <div class="col s12 m5">
    <p class="flow-text center-align">Puntos fuertes</p>
    <div class="card horizontal green lighten-2 black-text">
      <div class="card-stacked">
        <div class="card-content">
          <p>Alta <strong>diversificación sectorial</strong> con un índice de concentración del {{company.hhi_cnae_providers|floatformat:2}}</p>
        </div>
        <div class="card-content">
          <p>Bajo nivel <strong>de estacionalidad </strong> con un índice de concentración temporal del {{company.hhi_temporal_providers|floatformat:2}}</p>
        </div>
      </div>
    </div>
  </div>
  
  <div class="col s12 m5">
  <p class="flow-text center-align">Puntos a mejorar</p>
    <div class="card horizontal grey lighten-3 black-text">
      <div class="card-stacked">
        <div class="card-content">
          <p>Los proveedores tienen una <strong>baja dependencia</strong> ({{dependencia|mul:100|floatformat:0}}%), una cifra muy inferior a la de su competencia</p>
        </div>
        <div class="divider"></div>
        <div class="card-content">
          <p>Alta <strong>concentración de proveedores</strong> con un índice de concentración del {{hhi_providers|floatformat:2}}</p>
        </div>
        <div class="divider"></div>
        <div class="card-content">
          <p>Alta <strong>concentración geográfica</strong> con un índice de concentración del {{company.hhi_geografical_providers|floatformat:2}}</p>
        </div>
      </div>
    </div>
  </div>
  <div class="col s12 m1"></div>
</div>
{% endif %}

	<div class="row">
			    <!-- {{company.ebitda_avg_sector}} -->
			    <div class="grey-bckg">
			    	<div class="row grey-bckg padding_title">
		      	  		<div class="col s12 m2 line">
		      	  			<div class="center-align">
				            <i class="fa fa-user-o" aria-hidden="true"></i><span class="card-title"> Tus proveedores</span>
				            <h3 class="align-right orange-text darken-1">{{proveedores}}</h3>
				            <span class="green-text text-darken-1"><i class="fa fa-sort-up" aria-hidden="true"></i><span class="card-title">34%</span></span> <span class="light">Desde el mes pasado</span>
				            </div>
				        </div>

				        <div class="col s12 m2 line">
		      	  			<div class="center-align ">
				            <i class="fa fa-users" aria-hidden="true"></i><span class="card-title"> Proveedores comp.</span>
				            <h3 class="align-right orange-text darken-1">{{company.get_sector_providers|floatformat:0|intcomma}}</h3>
				            <span class="green-text text-darken-1"><i class="fa fa-sort-up" aria-hidden="true"></i><span class="card-title">10%</span></span> <span class="light">Desde el mes pasado</span>
				            </div>
				        </div>

				        <div class="col s12 m2 line">
		      	  			<div class="center-align ">
				            <i class="fa fa-rocket" aria-hidden="true"></i><span class="card-title"> Su dependencia</span>
				            <h3 class="align-right orange-text darken-1">{{dependencia|mul:100|floatformat:1|intcomma}}%</h3>
				            <span class="green-text text-darken-1"><i class="fa fa-sort-up" aria-hidden="true"></i><span class="card-title">5%</span></span> <span class="light">Desde el mes pasado</span>
				            </div>
				        </div>

				        <div class="col s12 m2 line">
		      	  			<div class="center-align ">
				            <i class="fa fa-cubes" aria-hidden="true"></i><span class="card-title"> Empresas comparables</span>
				            <h3 class="align-right orange-text darken-1">{{company.get_sector_companies.count}}</h3>
				            <span class="red-text text-darken-1"><i class="fa fa-sort-down" aria-hidden="true"></i><span class="card-title">7%</span></span> <span class="light">Desde el mes pasado</span>
				            </div>
				        </div>

				        <div class="col s12 m2 line">
		      	  			<div class="center-align ">
				            <i class="fa fa-eur" aria-hidden="true"></i><span class="card-title"> Pagos acumulados</span>
				            <h3 class="align-right orange-text darken-1">{{company.get_total_buys|floatformat:0|intcomma}}€</h3>
				            <span class="red-text text-darken-1"><i class="fa fa-sort-down" aria-hidden="true"></i><span class="card-title">4%</span></span> <span class="light">Desde el mes pasado</span>
				            </div>
				        </div>

				        <div class="col s12 m2">
		      	  			<div class="center-align ">
				            <i class="fa fa-money" aria-hidden="true"></i><span class="card-title"> Pago promedio</span>
				            <h3 class="align-right orange-text darken-1">{{company.average_transfer_to_provider|floatformat:0|intcomma}}€</h3>
				            <span class="green-text text-darken-1"><i class="fa fa-sort-up" aria-hidden="true"></i><span class="card-title">1%</span></span> <span class="light">Desde el mes pasado</span>
				            </div>
				        </div>
				    
				    </div>
				 </div>

				 <!-- /////////////////////////////////////////////////////////////
				 ////// ¿Como son mis clientes?
				 ///////////////////////////////////////////////////////////// -->

					<div class="white_back title_conf">
				    	<h3 class="flow-text">  Riesgo de incumplimiento - ¿Conoces el estado de tus proveedores?</h3>
				    </div>
			    	<div class="row title_conf">
			    	<!-- Resultado explotaciones -->
			    	<div class="row">
			    		<div class="col m6 s12">
			    			<div class="card grey lighten-4">
					            <div class="card-content grey-text darken-4">
					            	<span class="card-title">Riesgo de incumplimiento</span>
					              <canvas id="hats_graph" width="300" height="140"></canvas>
					            </div>
					        </div>
			    		</div>
			    		<div class="col m6 s12">
			    			<div class="card grey lighten-4">
					            <div class="card-content grey-text darken-4">
					              <blockquote>
					    				<p class="light"><i class="tiny material-icons indigo-text darken-4">live_help</i> Nuestra métrica de riesgo de impago clasifica tus proveedores según su probabilidad de entrar en problemas financieros en los próximos meses. Una alta concentración de proveedores en estado rojo podría ser preocupante para la evolución de tu negocio</p>
					    				<p class="light"><i class="tiny material-icons indigo-text darken-4">new_releases</i> <span class="bold"> En promedio, el riesgo de impago de tus proveedores es parecido al de los de tu competencia</p>
					    				<p class="light"><i class="tiny material-icons indigo-text darken-4">info</i> Puedes cubrir tu riesgo ampliando tu cartera de proveedores</p>
					    				<div class="row">
					    					<div class="col m5 s6"></div>
					    					<div class="col m7 s6">
					    						<span class="right-align"><a href="{% url 'empresas:providers' %}" id="download-button" target="_blank" class="btn waves-effect waves-light transparent grey-text text-darken-4 border-grey"> Nuevos proveedores </a> </span>
					    					</div>
					    				</div>
					    			</blockquote>
					            </div>
					        </div>
			    		</div>
			    	</div>
			    </div>
			    <!-- /////////////////////////////////////////////////////////////
				 ////// ¿Cómo me relaciono con ellos?
				 ///////////////////////////////////////////////////////////// -->

			    <div class="white_back title_conf">
			    	<h3 class="flow-text">Riesgo de concentración</h3>
			    </div>
		    	<div class="row title_conf">
		            <div class="col s12 m3">
		                <div class="card blue-grey lighten-1">
		                  <div class="card-content white-text">
		                    <h6 class="light">Proveedores</h6>
		                    <h4><i class="fa fa-user" aria-hidden="true"></i> {{hhi_providers|floatformat:2}}   <small style="color: red"><i class="fa fa-sort-down" aria-hidden="true"></i>  4%</small></h4>
		                  </div>
		                </div>
		              </div>
		              <div class="col s12 m3">
		                <div class="card blue-grey lighten-1">
		                  <div class="card-content white-text">
		                    <h6 class="light">Poveedores comparables</h6>
		                    <h4><i class="fa fa-user" aria-hidden="true"></i> {{company.hhi_providers_sector|floatformat:2}}   <small style="color: green"><i class="fa fa-sort-up" aria-hidden="true"></i>  4%</small></h4>
		                  </div>
		                </div>
		              </div>
		              <div class="col s12 m6">
		                <div class="card blue-grey lighten-1">
		                  <div class="card-content white-text">
		                    {{company.respuesta_riskprovider_concentracion_provider_hint}}
		                    <div class="row">
		    					<div class="col m4 s4"></div>
		    					<div class="col m8 s8">
		    						<span class="right-align"><a href="{% url 'empresas:providers' %}" target="_blank" class="btn waves-effect waves-light transparent white-text text-darken-4 border-grey"> Encuentra nuevos proveedores </a> </span>
		    					</div>
		    				</div>
		                  </div>
		                </div>
		              </div>
		    	</div>
		    	<div class="row title_conf">
		            <div class="col s12 m3">
		                <div class="card blue-grey lighten-1">
		                  <div class="card-content white-text">
		                    <h6 class="light">Geografica</h6>
		                    <h4><i class="fa fa-user" aria-hidden="true"></i> {{company.hhi_geografical_providers|floatformat:2}}   <small style="color: red"><i class="fa fa-sort-down" aria-hidden="true"></i>  4%</small></h4>
		                  </div>
		                </div>
		              </div>
		              <div class="col s12 m3">
		                <div class="card blue-grey lighten-1">
		                  <div class="card-content white-text">
		                    <h6 class="light">Geografica comparables</h6>
		                    <h4><i class="fa fa-user" aria-hidden="true"></i> {{company.hhi_geografical_sector_providers|floatformat:2}}   <small style="color: green"><i class="fa fa-sort-up" aria-hidden="true"></i>  4%</small></h4>
		                  </div>
		                </div>
		              </div>
		              <div class="col s12 m6">
		                <div class="card blue-grey lighten-1">
		                  <div class="card-content white-text">
		                    {{company.respuesta_riskprovider_concentracion_geografical_hint}}
		                    <div class="row">
		    					<div class="col m4 s4"></div>
		    					<div class="col m8 s8">
		    						<span class="right-align"><a href="{% url 'empresas:providers' %}" target="_blank" class="btn waves-effect waves-light transparent white-text text-darken-4 border-grey"> Encuentra nuevos proveedores </a> </span>
		    					</div>
		    				</div>
		                  </div>
		                </div>
		              </div>
		    	</div>
		    	<div class="row title_conf">
		            <div class="col s12 m3">
		                <div class="card blue-grey lighten-1">
		                  <div class="card-content white-text">
		                    <h6 class="light">Sector</h6>
		                    <h4><i class="fa fa-user" aria-hidden="true"></i> {{company.hhi_cnae_providers|floatformat:2}}   <small style="color: red"><i class="fa fa-sort-down" aria-hidden="true"></i>  4%</small></h4>
		                  </div>
		                </div>
		              </div>
		              <div class="col s12 m3">
		                <div class="card blue-grey lighten-1">
		                  <div class="card-content white-text">
		                    <h6 class="light">Sector comparables</h6>
		                    <h4><i class="fa fa-user" aria-hidden="true"></i> {{company.hhi_cnae_sector_providers|floatformat:2}}   <small style="color: green"><i class="fa fa-sort-up" aria-hidden="true"></i>  4%</small></h4>
		                  </div>
		                </div>
		              </div>
		              <div class="col s12 m6">
		                <div class="card blue-grey lighten-1">
		                  <div class="card-content white-text">
		                    {{company.respuesta_riskprovider_concentracion_cnae_hint}}
		                    <div class="row">
		    					<div class="col m4 s4"></div>
		    					<div class="col m8 s8">
		    						<span class="right-align"><a href="{% url 'empresas:providers' %}" target="_blank" class="btn waves-effect waves-light transparent white-text text-darken-4 border-grey"> Encuentra nuevos proveedores </a> </span>
		    					</div>
		    				</div>
		                  </div>
		                </div>
		              </div>
		    	</div>
		    	<div class="row title_conf">
		            <div class="col s12 m3">
		                <div class="card blue-grey lighten-1">
		                  <div class="card-content white-text">
		                    <h6 class="light">Estacionalidad</h6>
		                    <h4><i class="fa fa-user" aria-hidden="true"></i> {{company.hhi_temporal_providers|floatformat:2}}   <small style="color: red"><i class="fa fa-sort-down" aria-hidden="true"></i>  4%</small></h4>
		                  </div>
		                </div>
		              </div>
		              <div class="col s12 m3">
		                <div class="card blue-grey lighten-1">
		                  <div class="card-content white-text">
		                    <h6 class="light">Estacionalidad comparables</h6>
		                    <h4><i class="fa fa-user" aria-hidden="true"></i> {{company.hhi_temporal_sector_providers|floatformat:2}}   <small style="color: green"><i class="fa fa-sort-up" aria-hidden="true"></i>  4%</small></h4>
		                  </div>
		                </div>
		              </div>
		              <div class="col s12 m6">
		                <div class="card blue-grey lighten-1">
		                  <div class="card-content white-text">
		                    {{company.respuesta_riskprovider_concentracion_temporal_hint}}
		                    <div class="row">
		    					<div class="col m4 s4"></div>
		    					<div class="col m8 s8">
		    						<span class="right-align"><a href="{% url 'empresas:providers' %}" target="_blank" class="btn waves-effect waves-light transparent white-text text-darken-4 border-grey"> Encuentra nuevos proveedores </a> </span>
		    					</div>
		    				</div>
		                  </div>
		                </div>
		              </div>
		    	</div>
	  </div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.1.4/Chart.bundle.min.js"></script>

<script type="text/javascript">

	Chart.defaults.global.legend.display = false;
	// And for a doughnut chart
  	var hats_graph = document.getElementById("hats_graph");
  	var frecuencia_graph = document.getElementById("frecuencia_graph");
  	var penetration_graph = document.getElementById("penetration_graph");
  	var penetracion_clientes = 0.12
	var penetracion_clientes_sector = 0.35//{{company.my_sector_penetration}}
  	
  	HatsBarGraph(hats_graph, {{riesgo_impago_proveedores|safe}}, {{riesgo_impago_providers_sector|safe}} )
  	LineGraph(frecuencia_graph, {{get_monthly_sector_avg_sells|safe}}, {{get_monthly_sells|safe}});
  	stackedbarchart(penetration_graph, 'hola_2', 'hola_2', penetracion_clientes, penetracion_clientes_sector, 'Penetration')


  	// prepare data...
  	function HatsBarGraph(div, data_you, data_sector) {//, data_sector, data_you) {
  		var labels = [];
  		var data_1=[];
  		var data_2=[];
  		var data_3=[];
  		var sector = data_sector
  		var you = data_you
  		you.forEach(function(packet, i) {
	      labels.push(packet.hats_alert);
	      if (packet.hats_alert=='ROJA') {
	      	data_1.push(packet.c);
	      } else if (packet.hats_alert=='AMARILLA') {
	      	data_2.push(packet.c);
	      } else if (packet.hats_alert=='VERDE') {
	      	data_3.push(packet.c);
	      }
	    });
	    sector.forEach(function(packet, i) {
	      if (packet.hats_alert=='ROJA') {
	      	data_1.push(packet.c);
	      } else if (packet.hats_alert=='AMARILLA') {
	      	data_2.push(packet.c);
	      } else if (packet.hats_alert=='VERDE') {
	      	data_3.push(packet.c);
	      }
	    });
	    hats_barchart(div, data_1, data_2, data_3, "Riesgo de impago") //barchart(div, labels_1, labels_2, data_1, data_2, '# Transferencias / mes')
  	}

  	// prepare data...
  	function LineGraph(div, data_sector, data_you) {
  		var labels_1 = [];
  		var labels_2 = []; 
  		var data_1=[];
  		var data_2=[];
  		var sector = data_sector
  		var you = data_you
  		sector.forEach(function(packet, i) {
	      labels_1.push(packet.month);
	      data_1.push(packet.c);
	    });
	    you.forEach(function(packet, i) {
	    	console.log('Line Graphs')
	    	console.log(labels_1)
	    	console.log(packet.month)
	    	console.log(labels_1.includes(packet.month))
	      	if (labels_1.includes(packet.month)==true) {
	    		labels_2.push(packet.month);
	      		data_2.push(packet.c);
	    	} else {
	    		labels_2.push(labels_1[i]);
	      		data_2.push(0);
	    	}
	    });
	    // console.log(facturacion_graph)
	    // console.log(labels_1)
	    // console.log(labels_2)
	    // console.log(data_1)
	    // console.log(data_2)
	    line(div, labels_1, labels_2, data_1, data_2)
  	}

  	function stackedbarchart(div, labels_1, labels_2, data_1, data_2, title)
        {
        	if (data_1<1) {
        		data_1x = data_1*100
        	} else {
        		data_1x = 100
        	}
        	if (data_2<1) {
        		data_2x = data_2*100
        	} else {
        		data_2x = 100
        	}
        	var dataset_1 = [data_1x,data_2x]
        	var dataset_2 = [100-data_1x,100-data_2x]
        	console.log(dataset_1)
        	console.log(dataset_2)
        	var myChart = new Chart(div, {
		        type: 'bar',
		        data: {
		            labels: ["You","Comparables"],
		            datasets: [{
		            	type: 'bar',
		                label: "Penetration",
		                data: dataset_1,
		                backgroundColor: 'rgba(47,79,79, 0.2)',
		                borderColor: 'rgba(47,79,79, 1)',
		                borderWidth: 2
		            },
		            {
		            	type: 'bar',
		                label: "Rest of the market",
		                data: dataset_2,
		                backgroundColor: 'rgba(169,169,169, 0.2)',
		                borderColor: 'rgba(169,169,169, 1)',
		                borderWidth: 2
		            }]
		        },
		        options: {
		            legend: {
		                display: false,
		                labels: {
		                    fontColor: 'rgb(255, 99, 132)'
		                }
		            },
		            scales: {
		                yAxes: [{
						    stacked: true
		                }],
		                xAxes: [{
					        stacked: true
					    }]
		            }
		        }
		    });
    	}

    function hats_barchart(div, data_1, data_2, data_3, title)
        {
        	
        	var myChart = new Chart(div, {
		        type: 'bar',
		        data: {
		            labels: ["Tu","Comparables"],
		            datasets: [{
		            	type: 'bar',
		                label: "Alerta Roja",
		                data: data_1,
		                backgroundColor: ['rgba(200,0,0,0.2)','rgba(200,0,0,0.2)'],
		                borderColor: 'rgba(47,79,79, 1)',
		                borderWidth: 2
		            },{
		            	type: 'bar',
		                label: "Alerta Amarilla",
		                data: data_2,
		                backgroundColor: ['rgba(150,150,0,0.2)','rgba(150,150,0,0.2)'],
		                borderColor: 'rgba(47,79,79, 1)',
		                borderWidth: 2
		            },{
		            	type: 'bar',
		                label: "Sin alerta",
		                data: data_3,
		                backgroundColor: ['rgba(0,200,0,0.2)','rgba(0,200,0,0.2)'],
		                borderColor: 'rgba(47,79,79, 1)',
		                borderWidth: 2
		            }
		            ]
		        },
		        options: {
		            legend: {
		                display: false,
		                labels: {
		                    fontColor: 'rgb(255, 99, 132)'
		                }
		            },
		            scales: {
		                yAxes: [{
						    stacked: true,
						    ticks: {
				                beginAtZero: true
				            }
		                }],
		                xAxes: [{
					        stacked: true
					    }]
		            }
		        }
		    });
    	}

    function pie(div, data, labels)
        {
           var myDoughnutChart = new Chart(div, {
            type: 'pie',
            data: {
                labels: labels,
                datasets: [
                    {
                        data: data,
                        backgroundColor: [
                            'rgba(128,128,128, 0.5)',
                            'rgba(47,79,79, 0.5)',
                            'rgba(119,136,153, 0.5)',
                            'rgba(192,192,192, 0.5)',
		                    'rgba(169,180,169, 0.5)',
		                    'rgba(128,128,128, 0.5)',
                    		'rgba(220,220,220, 0.5)',
                        ],
                        hoverBackgroundColor: [
                            'rgba(128,128,128, 1)',
                            'rgba(47,79,79, 1)',
                            'rgba(119,136,153, 1)',
                            'rgba(192,192,192, 1)',
		                    'rgba(169,180,169, 1)',
		                    'rgba(128,128,128, 1)',
                    		'rgba(220,220,220, 1)',
                        ]
                    }]
            },
            animation:{
                animateScale:true
            }
        });
        }

  	function donut(div, data, labels)
        {
           var myDoughnutChart = new Chart(div, {
            type: 'doughnut',
            data: {
                labels: labels,
                datasets: [
                    {
                        data: data,
                        backgroundColor: [
                            'rgba(128,128,128, 0.5)',
                            'rgba(47,79,79, 0.5)',
                            'rgba(119,136,153, 0.5)',
                            'rgba(192,192,192, 0.5)',
		                    'rgba(169,180,169, 0.5)',
		                    'rgba(128,128,128, 0.5)',
                    		'rgba(220,220,220, 0.5)',
                        ],
                        hoverBackgroundColor: [
                            'rgba(128,128,128, 1)',
                            'rgba(47,79,79, 1)',
                            'rgba(119,136,153, 1)',
                            'rgba(192,192,192, 1)',
		                    'rgba(169,180,169, 1)',
		                    'rgba(128,128,128, 1)',
                    		'rgba(220,220,220, 1)',
                        ]
                    }]
            },
            animation:{
                animateScale:true
            }
        });
        }

    function line(div, labels, labels2, data1, data2) {
    	var scatterChart = new Chart(div, {
        type: 'line',
        data: {
            labels: labels,
            datasets: [{
            label: "Comparables",
            backgroundColor: "rgba(220,220,220,0.5)",
            borderColor: "rgba(220,220,220,0.8)",
            highlightFill: "rgba(220,220,220,0.75)",
            pointHoverBackgroundColor: "rgba(220,220,220,1)",
            showTooltip: false, //NEW OPTION DON"T NEED TO INCLUDE IT IF YOU WANT TO DISPLAY BUT WON"T HURT IF YOU DO
            yAxisID: "y-axis-0",
            data: data1
        }, {
            label: "{{company.name|safe}}",
            backgroundColor: "rgba(47,79,79,0.5)",
            borderColor: "rgba(47,79,79,0.8)",
            highlightFill: "rgba(47,79,79,0.75)",
            pointHoverBackgroundColor: "rgba(47,79,79,1)",
            showTooltip: false, //NEW OPTION DON"T NEED TO INCLUDE IT IF YOU WANT TO DISPLAY BUT WON"T HURT IF YOU DO
            yAxisID: "y-axis-1",
            data: data2
        }]},
        options: {
          responsive: true,
          pointDotRadius: 10,
          bezierCurve: false,
          scaleShowVerticalLines: false,
          scaleGridLineColor: 'black',
          scales: {
		      yAxes: [{
		        position: "left",
		        "id": "y-axis-0",
		        
		      }, {
		        position: "right",
		        "id": "y-axis-1",
		        
		      }]
		  }
        }
    });
    }
</script>
{% endblock %}

 {% block alt_js %}
<script type="text/javascript">

	$(document).ready(function(){

	});


</script>
{% endblock alt_js %}
