{% extends "app_base.html" %}
{% load static %}
{% load humanize %}
{% block page_title %}
{{ title }}
{% endblock %}
{% load random_image %}
{% load mathfilters %}

{% block body_class %}background_grey{% endblock %}

{% block content %}
		
	<div class="parallax-container">
		<h3 class="center-align white-text light">Providers change your efficiency</h3>
	    <div class="parallax"><img src="{% static 'images/providers.jpg' %}"></div>
	</div>
    <h4 class="center title light padding_title">New clients found for <a href='{{ company.get_absolute_url }}'>{{company.name}}</a></h4>
    <h6 class="light center">Region: {{ company.territorial }}</h6>
    <h6 class="light center">CNAE: {{ company.cnae_2 }} | {{ company.cnae }}</h6>
    <!-- <h6 class="light center">{{ company.transfers.count }} transfers ({{ company.average_transfer | floatformat }}€ average transfer amount)</h6> -->
    <h6 class="light center">{{ company.providers_recommended.count }} Recomendaciones | {{ company.transfers.count }} Transferencias</h6>

      <div class="row">
      	  <div class="col s3 m3">

      	  		<div class="col s12 m12">
		          <div class="card blue-grey darken-1">
		            <div class="card-content white-text">
		              <span class="card-title">New clients recommendations...</span>
		              <p>We have selected for you several potencial clients that might fit your need and enlarge your customers portfolio.</p>
		            </div>
		            <div class="card-action">
		              <a href="#" id="client_form_button">Filter recommendation</a>
		            </div>
		          </div>
		        </div>

		        <div class="col s12 m12">
		          <div class="card blue-grey darken-1">
		            <div class="card-content white-text">
		              <span class="card-title">... but, wait, how does it work?</span>
		              <p>Using your payment transfers data and the ones from your competitors, we can recommend you highly personalized new customers opportunities.</p>
		            </div>
		            <div class="card-action">
		              <a href="#">Back to school</a>
		            </div>
		          </div>
		        </div>

      	  </div>


	      <div class="col s9 l9">
			<!-- Page Layout here -->
		    	<div id="cards_container">
		    		<div class="row">
		    		<div class="col s12 m4 cards-container">

					{% for obj in company.providers_recommended.all %}
						{% if  obj.similarity > -1000 %}
							{% if  forloop.counter|add:"-1"|divisibleby:3 %}
							<div class="card brown lighten-5 hoverable">
							    <div class="card-image waves-effect waves-block waves-light">
							      <img class="activator" src="{{ obj.clientes_recomendados.image}}">
							    </div>
							    <div class="card-content">
							    	<div class="row">
							      		<span class="activator center-align grey-text text-darken-4">{{forloop.counter}}. {{ obj.clientes_recomendados.name}}</span>
							      	</div>
							      	<div class="divider"></div>
							      	<br>
							      	<div class="row">
							      		<div class="col s6">
							      			<i class="fa fa-bullseye left-align" aria-hidden="true"></i><span class="grey-text light text-darken-4"> Match: 
							      		</div>
							      		<div class="col s6">
							      			<span class="right-align flow-text" style="color: {% if obj.similarity > 0.7 %}green{% elif obj.similarity > 0.3 %} orange{% else %}red{% endif %}"> {{ obj.similarity|floatformat }}</span></span>
							      		</div>
							      	</div>

							      	<div class="row">
							      		<div class="col s6">
							      			<i class="fa fa-money left-align" aria-hidden="true"></i></i><span class="grey-text light text-darken-4"> Financing: 
							      		</div>
							      		<div class="col s6">
							      			<span class="right-align flow-text" style="color: {% if obj.clientes_recomendados.estados_financieros.last.ebitda > 0 %}green{% else %}red{% endif %}"> {% if obj.clientes_recomendados.estados_financieros.last.ebitda > 0%} {{obj.clientes_recomendados.estados_financieros.last.ebitda|mul:0.2|floatformat|intcomma }}€{% else %}-{%endif%}</span></span>
							      		</div>
							      	</div>
								    <div class="card-action">
								    	<a class="blue-grey-text text-darken-3" href="{{ obj.clientes_recomendados.get_absolute_url }}">See details</a>
								      	<span ><i class="material-icons right activator center">more_vert</i></span>
								    </div>
							    </div>
							    <div class="card-reveal">
							    	<span class="card-title">Actividad:<i class="material-icons right">close</i></span>
							    	<div class="row">
							      		<p class="grey-text text-darken-4">{{ obj.clientes_recomendados.cnae_2 }}</p>
							      		<p class="grey-text text-darken-4">{{ obj.clientes_recomendados.cnae }}</p>
							      	</div>
							      	<span class="card-title">Localización:</span>
							      	<div class="row">
							      		<p class="grey-text text-darken-4">{{ obj.clientes_recomendados.territorial }}</p>
							      	</div>
							    </div>
							</div>

							{% endif %}
					    {% endif %}
					{% endfor %}
					</div>

					<!-- =================== -->

					<div class="col s12 m4 cards-container">
						{% for obj in company.providers_recommended.all %}
						
							{% if  obj.similarity > -1000 %}

							{% if forloop.counter|add:"-2"|divisibleby:3 %}

							<div class="card brown lighten-5 hoverable">
							    <div class="card-image waves-effect waves-block waves-light">
							      <img class="activator" src='{{ obj.clientes_recomendados.image}}'>
							    </div>
							    <div class="card-content">
							    	<div class="row">
							      		<span class="activator center-align grey-text text-darken-4">{{forloop.counter}}. {{ obj.clientes_recomendados.name}}</span>
							      	</div>
							      	<div class="divider"></div>
							      	<br>
							      	<div class="row">
							      		<div class="col s6">
							      			<i class="fa fa-bullseye left-align" aria-hidden="true"></i><span class="grey-text light text-darken-4"> Match: 
							      		</div>
							      		<div class="col s6">
							      			<span class="right-align flow-text" style="color: {% if obj.similarity > 0.7 %}green{% elif obj.similarity > 0.3 %} orange{% else %}red{% endif %}"> {{ obj.similarity|floatformat }}</span></span>
							      		</div>
							      	</div>

							      	<div class="row">
							      		<div class="col s6">
							      			<i class="fa fa-money left-align" aria-hidden="true"></i></i><span class="grey-text light text-darken-4"> Financing: 
							      		</div>
							      		<div class="col s6">
							      			<span class="right-align flow-text" style="color: {% if obj.clientes_recomendados.estados_financieros.last.ebitda > 0 %}green{% else %}red{% endif %}"> {% if obj.clientes_recomendados.estados_financieros.last.ebitda > 0%} {{obj.clientes_recomendados.estados_financieros.last.ebitda|mul:0.2|floatformat|intcomma }}€{% else %}-{%endif%}</span></span>
							      		</div>
							      	</div>
								    <div class="card-action">
								    	<a class="blue-grey-text text-darken-3" href="{{ obj.clientes_recomendados.get_absolute_url }}">See details</a>
								      	<span ><i class="material-icons right activator center">more_vert</i></span>
								    </div>
							    </div>
							    <div class="card-reveal">
							    	<span class="card-title">Actividad:<i class="material-icons right">close</i></span>
							    	<div class="row">
							      		<p class="grey-text text-darken-4">{{ obj.clientes_recomendados.cnae_2 }}</p>
							      		<p class="grey-text text-darken-4">{{ obj.clientes_recomendados.cnae }}</p>
							      	</div>
							      	<span class="card-title">Localización:</span>
							      	<div class="row">
							      		<p class="grey-text text-darken-4">{{ obj.clientes_recomendados.territorial }}</p>
							      	</div>
							    </div>
							</div>

							{% endif %}
					    {% endif %}
					{% endfor %}
					</div>

					<div class="col s12 m4 cards-container">
						{% for obj in company.providers_recommended.all %}

							{% if  obj.similarity > -1000 %}
						
							{% if forloop.counter|add:"-3"|divisibleby:3 %}

							<div class="card brown lighten-5 hoverable">
							    <div class="card-image waves-effect waves-block waves-light">
							      <img class="activator" src='{{ obj.clientes_recomendados.image}}'>
							    </div>
							    <div class="card-content">
							    	<div class="row">
							      		<span class="activator center-align grey-text text-darken-4">{{forloop.counter}}. {{ obj.clientes_recomendados.name}}</span>
							      	</div>
							      	<div class="divider"></div>
							      	<br>
							      	<div class="row">
							      		<div class="col s6">
							      			<i class="fa fa-bullseye left-align" aria-hidden="true"></i><span class="grey-text light text-darken-4"> Match: 
							      		</div>
							      		<div class="col s6">
							      			<span class="right-align flow-text" style="color: {% if obj.similarity > 0.7 %}green{% elif obj.similarity > 0.3 %} orange{% else %}red{% endif %}"> {{ obj.similarity|floatformat }}</span></span>
							      		</div>
							      	</div>

							      	<div class="row">
							      		<div class="col s6">
							      			<i class="fa fa-money left-align" aria-hidden="true"></i></i><span class="grey-text light text-darken-4"> Financing: 
							      		</div>
							      		<div class="col s6">
							      			<span class="right-align flow-text" style="color: {% if obj.clientes_recomendados.estados_financieros.last.ebitda > 0 %}green{% else %}red{% endif %}"> {% if obj.clientes_recomendados.estados_financieros.last.ebitda > 0%} {{obj.clientes_recomendados.estados_financieros.last.ebitda|mul:0.2|floatformat|intcomma }}€{% else %}-{%endif%}</span></span>
							      		</div>
							      	</div>
								    <div class="card-action">
								    	<a class="blue-grey-text text-darken-3" href="{{ obj.clientes_recomendados.get_absolute_url }}">See details</a>
								      	<span ><i class="material-icons right activator center">more_vert</i></span>
								    </div>
							    </div>
							    <div class="card-reveal">
							    	<span class="card-title">Actividad:<i class="material-icons right">close</i></span>
							    	<div class="row">
							      		<p class="grey-text text-darken-4">{{ obj.clientes_recomendados.cnae_2 }}</p>
							      		<p class="grey-text text-darken-4">{{ obj.clientes_recomendados.cnae }}</p>
							      	</div>
							      	<span class="card-title">Localización:</span>
							      	<div class="row">
							      		<p class="grey-text text-darken-4">{{ obj.clientes_recomendados.territorial }}</p>
							      	</div>
							    </div>
							</div>

					    {% endif %}

				    {% endif %}

				{% endfor %}
				</div>

				</div>
		    	</div>
		</div>
	</div>

	<!-- Modal Structure -->
	<div id="modal_clients" class="modal">
		<div class="modal-content">
			<h5>What are you looking for?</h5>
			<div class="divider"></div>
			<div class="row">
				<form method="GET" action="">
				    <div class="row">
			        	<div class="input-field col s6">
				          <p class="flow-text">Any special sector?</p>
				        </div>
				    	<div class="input-field col s6">
							<i class="material-icons prefix">business</i>
							<input type="text" id="autocomplete-input" class="autocomplete">
							<label for="autocomplete-input">Activity of your desired new client</label>
						</div>
					</div>
					<div class="row">
			        	<div class="input-field col s6">
				          <p class="flow-text">Any special region?</p>
				        </div>
			        	<div class="col s6">
			        		<br>
				        	<div class="switch">
						    	<label>
						      	Anywhere
						      	<input type="checkbox" id="region_checkbox">
						      	<span class="lever"></span>
						      	Just my region
						    </label>
							</div>
					  	</div>
					</div>
					<div class="row">
			        	<div class="input-field col s6">
				          <p class="flow-text">Any minimum billing?</p>
				        </div>
					  	<div class="col s6">
						  	<p class="range-field">
						  		<label>Minimum billing? (in k€)</label>
						      	<input type="range" id="test5" min="0" max="1000" />
						    </p>
						</div>
					</div>
					<div class="row">
			        	<div class="input-field col s6">
				          <p class="flow-text">We want to know what are your needs in order to help you reach your spectations</p>
				        </div>
				        <div class="input-field col s6">
				          <i class="material-icons prefix">mode_edit</i>
				          <textarea id="comment" class="materialize-textarea"></textarea>
				          <label for="comment">Write us your comments</label>
				        </div>
				    </div>
					<!-- Switch -->
				  	
			    </form>
			</div>

			<div class="progress ajax_bar">
		    	<div class="indeterminate"></div>
		  	</div>

		</div>
		<div class="modal-footer">
			<a href="#!" id="client_form" class=" modal-action modal-close waves-effect waves-green btn-flat">Give me new clients!</a>
		</div>
	</div>

{% block alt_js %}
<script type="text/javascript">
	console.log({{loading_times}})
	if ({{loading_times}}==1) {
	    document.getElementById("modal_clients").modal('open');
	}
</script>
{% endblock alt_js %}

{% endblock %}



  
